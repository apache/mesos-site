<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Apache Mesos - IPC Namespace Isolator in Mesos Containerizer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta property="og:locale" content="en_US"/>
    <meta property="og:type" content="website"/>
    <meta property="og:title" content="Apache Mesos"/>
    <meta property="og:site_name" content="Apache Mesos"/>
    <meta property="og:url" content="https://mesos.apache.org/"/>
    <meta property="og:image" content="https://mesos.apache.org/assets/img/mesos_logo_fb_preview.png"/>
    <meta property="og:description"
          content="Apache Mesos abstracts resources away from machines,
                   enabling fault-tolerant and elastic distributed systems
                   to easily be built and run effectively."/>

    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:site" content="@ApacheMesos"/>
    <meta name="twitter:title" content="Apache Mesos"/>
    <meta name="twitter:image" content="https://mesos.apache.org/assets/img/mesos_logo_fb_preview.png"/>
    <meta name="twitter:description"
          content="Apache Mesos abstracts resources away from machines,
                   enabling fault-tolerant and elastic distributed systems
                   to easily be built and run effectively."/>

    <link href="../../../../assets/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="alternate" type="application/atom+xml" title="Apache Mesos Blog" href="/blog/feed.xml">
    <link href="../../../../assets/css/main.css" rel="stylesheet" />


  </head>
  <body>
    <!-- magical breadcrumbs -->
    <div class="topnav">
      <div class="container">
        <ul class="breadcrumb">
          <li>
            <div class="dropdown">
              <a data-toggle="dropdown" href="#">Apache Software Foundation <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                <li><a href="https://www.apache.org">Apache Homepage</a></li>
                <li><a href="https://www.apache.org/licenses/">License</a></li>
                <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
                <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
                <li><a href="https://www.apache.org/security/">Security</a></li>
              </ul>
            </div>
          </li>

          <li><a href="https://mesos.apache.org">Apache Mesos</a></li>
          <li><a href="/documentation/">Documentation</a></li>
        </ul><!-- /.breadcrumb -->
      </div><!-- /.container -->
    </div><!-- /.topnav -->

    <!-- navbar excitement -->
<div class="navbar navbar-default navbar-static-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#mesos-menu" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/"><img src="/assets/img/mesos_logo.png" alt="Apache Mesos logo"/></a>
    </div><!-- /.navbar-header -->

    <div class="navbar-collapse collapse" id="mesos-menu">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="/getting-started/">Getting Started</a></li>
        <li><a href="/blog/">Blog</a></li>
        <li><a href="/documentation/latest/">Documentation</a></li>
        <li><a href="/downloads/">Downloads</a></li>
        <li><a href="/community/">Community</a></li>
      </ul>
    </div><!-- /#mesos-menu -->
  </div><!-- /.container -->
</div><!-- /.navbar -->

<div class="content">
  <div class="container">
    <div class="row-fluid">
  <div class="col-md-4">
    <h4>If you're new to Mesos</h4>
    <p>See the <a href="/getting-started/">getting started</a> page for more
       information about downloading, building, and deploying Mesos.</p>

    <h4>If you'd like to get involved or you're looking for support</h4>
    <p>See our <a href="/community/">community</a> page for more details.</p>
  </div>
  <div class="col-md-8">
    <h1>IPC Namespace Isolator in Mesos Containerizer</h1>

<p>The IPC Namespace isolator can be used on Linux to place container in a
distinct IPC namespace (for isolating System V IPC resources and POSIX
message queue) and provide the container its own /dev/shm (for isolating
POSIX shared memory). The benefits of this are:</p>

<ol>
<li><p>Visibility: Any IPC objects created in the container are private and
cannot be seen by any other containers.</p></li>
<li><p>Clean termination: When the container is destroyed, any IPC objects
created in the container will be automatically removed.</p></li>
</ol>


<p>To enable the IPC namespace isolator, append <code>namespaces/ipc</code> to the <code>--isolation</code>
flag when starting the agent. Note that <code>filesystem/linux</code> isolator is required
for turning on IPC namespace isolator.</p>

<p>Framework users can control the behavior of a container&rsquo;s IPC namespace
and /dev/shm by setting the <code>ContainerInfo.linux_info.ipc_mode</code> field:</p>

<ol>
<li><p>If set to <code>SHARE_PARENT</code>, the container will share the IPC namespace and
/dev/shm with its parent. If the container is a top level container,
it will share the IPC namespace and /dev/shm with the agent host, if
the container is a nested container, it will share the IPC namespace
and /dev/shm with its parent container. The implication is if a nested
container wants to share the IPC namespace and /dev/shm with the agent
host, its parent container has to do it first.</p></li>
<li><p>If set to <code>PRIVATE</code>, the container will have its own IPC namespace and
/dev/shm.</p></li>
<li><p>If not set, for backward compatibility we will keep the previous behavior:
Top level container will have its own IPC namespace and nested container
will share the IPC namespace with its parent container. If the container
does not have its own rootfs, it will share agent&rsquo;s /dev/shm, otherwise
it will have its own /dev/shm.</p></li>
</ol>


<p>As a security measure, operators can disallow any containers to share the
agent&rsquo;s IPC namespace and /dev/shm by setting the agent flag
<code>--disallow_sharing_agent_ipc_namespace</code> to <code>true</code>. If this agent flag is set to <code>false</code>
and the framework requests to launch a top level container to share the
agent&rsquo;s IPC namespace and /dev/shm, the container launch will be rejected.</p>

<p>Framework users can specify the size of a container&rsquo;s /dev/shm in MB by
setting the <code>ContainerInfo.linux_info.shm_size</code> field, and operators can specify
the default size of /dev/shm via the agent flag <code>--default_container_shm_size</code>.
So if the <code>ContainerInfo.linux_info.shm_size</code> field is not set, the size of
container&rsquo;s /dev/shm will be value of the <code>--default_container_shm_size</code> agent
flag, if that flag is not set too, the size of the /dev/shm will be half
of the agent host RAM which is the default behavior of Linux. The
<code>ContainerInfo.linux_info.shm_size</code> field will be ignored for the container which
shares its parent&rsquo;s /dev/shm.</p>

<p>Please note that we only support setting the <code>ContainerInfo.linux_info.shm_size</code> field
when the <code>ContainerInfo.linux_info.ipc_mode</code> field is set to <code>PRIVATE</code>, otherwise the
container launch will be rejected.</p>

  </div>
</div>

  </div><!-- /.container -->
</div><!-- /.content -->

<hr>



    <!-- footer -->
    <div class="footer">
      <div class="container">

        <div class="col-md-12 trademark">
          <p>&copy; 2012-2022 <a href="https://apache.org">The Apache Software Foundation</a>.
            Apache Mesos, the Apache feather logo, and the Apache Mesos project logo are trademarks of The Apache Software Foundation.
          <p>
        </div>

      </div><!-- /.container -->
    </div><!-- /.footer -->

    <!-- JS -->
    <script src="../../../../assets/js/jquery-1.11.0.min.js"></script>
    <script src="../../../../assets/js/bootstrap.min.js"></script>
    <script src="../../../../assets/js/anchor-4.1.0.min.js"></script>

    <!-- Inject anchors for all headings on the page, see https://www.bryanbraun.com/anchorjs. -->
    <script type="text/javascript">
    anchors.options = {
      placement: 'right',
      ariaLabel: 'Permalink',
    };

    // The default is to not add anchors to h1, but we have pages with multiple h1 headers,
    // and we do want to put anchors on those.
    anchors.add('h1, h2, h3, h4, h5, h6');
    </script>
  </body>
</html>
